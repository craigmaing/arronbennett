---
/**
 * Card Component
 *
 * A versatile card component for displaying content in a contained format.
 * Supports multiple variants including service cards, testimonials, and features.
 *
 * @component
 * @example
 * <Card title="Service Title" description="Description text">
 *   <slot />
 * </Card>
 */

import type { CardProps } from '../types/components';

interface Props extends CardProps {}

const {
  variant = 'default',
  title,
  description,
  image,
  imageAlt = '',
  href,
  class: className = '',
} = Astro.props;

// Base card styles
const baseStyles = `
  bg-white rounded-xl overflow-hidden
  transition-all duration-300 ease-in-out
`;

// Variant-specific styles
const variantStyles = {
  default: `
    border border-gray-200
    hover:shadow-lg hover:border-navy-200
  `,
  service: `
    border-2 border-navy-100
    hover:border-navy-300 hover:shadow-xl
    hover:-translate-y-1
  `,
  testimonial: `
    border border-gray-100
    shadow-lg hover:shadow-xl
  `,
  feature: `
    border border-gray-200
    hover:border-coral-200 hover:shadow-lg
  `,
};

const cardClass = `
  ${baseStyles}
  ${variantStyles[variant]}
  ${className}
`.trim().replace(/\s+/g, ' ');

// Determine wrapper element
const WrapperTag = href ? 'a' : 'article';
const wrapperProps = href
  ? { href, class: cardClass }
  : { class: cardClass };
---

<WrapperTag {...wrapperProps}>
  {image && (
    <div class="aspect-video w-full overflow-hidden">
      <img
        src={image}
        alt={imageAlt}
        class="w-full h-full object-cover transition-transform duration-300 hover:scale-105"
        loading="lazy"
      />
    </div>
  )}

  <div class="p-6">
    {title && (
      <h3 class="text-xl font-semibold text-navy-900 mb-3">
        {title}
      </h3>
    )}

    {description && (
      <p class="text-gray-700 mb-4 leading-relaxed">
        {description}
      </p>
    )}

    <div class="card-content">
      <slot />
    </div>
  </div>

  {href && (
    <div class="px-6 pb-6">
      <span class="inline-flex items-center gap-2 text-navy-700 font-medium group">
        Learn more
        <svg
          class="w-4 h-4 transition-transform group-hover:translate-x-1"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </span>
    </div>
  )}
</WrapperTag>

<style>
  /* Card link styles */
  a[class*="card"] {
    text-decoration: none;
    display: block;
    color: inherit;
  }

  /* Smooth image zoom on hover */
  .aspect-video {
    position: relative;
  }

  /* Focus styles for accessibility */
  a[class*="card"]:focus-visible {
    outline: 2px solid var(--color-navy-500);
    outline-offset: 4px;
    border-radius: 0.75rem;
  }
</style>
